<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <title>Carrinho Bagunçado</title>
  </head>
  <body>
    <h1>Resumo do Carrinho</h1>
    <p>Total bruto: <strong id="total-bruto">--</strong></p>
    <p>Desconto: <strong id="total-desconto">--</strong></p>
    <p>Total final: <strong id="total-final">--</strong></p>

    <script>
      // --- Dados misturados com lógica ---
      const produtos = [
        { id: 1, nome: "Teclado", preco: 120 },
        { id: 2, nome: "Mouse", preco: 80 },
        { id: 3, nome: "Monitor", preco: 999 },
      ]

      const carrinho = [
        { id: 1, qtd: 1 },
        { id: 2, qtd: 2 },
      ]

      const TAXA_DESCONTO = 10

      // --- Funções dentro do mesmo script (sem reaproveitamento) ---
      function encontrarProduto(id) {
        for (let p of produtos) {
          if (p.id === id) return p
        }
      }

      function calcularTotal() {
        let total = 0
        for (let item of carrinho) {
          const produto = encontrarProduto(item.id)
          total += produto.preco * item.qtd
        }
        return total
      }

      function aplicarDesconto(valor, taxa) {
        return valor - valor * (taxa / 100)
      }

      function formatarBRL(valor) {
        return valor.toLocaleString("pt-BR", {
          style: "currency",
          currency: "BRL",
        })
      }

      // --- Mistura de cálculo com manipulação de DOM ---
      const totalBruto = calcularTotal()
      const totalComDesconto = aplicarDesconto(totalBruto, TAXA_DESCONTO)

      document.getElementById("total-bruto").textContent =
        formatarBRL(totalBruto)
      document.getElementById("total-desconto").textContent = formatarBRL(
        totalBruto - totalComDesconto
      )
      document.getElementById("total-final").textContent =
        formatarBRL(totalComDesconto)
    </script>
  </body>
</html>
